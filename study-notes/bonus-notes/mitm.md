# DNS 스푸핑과 중간자 공격(MITM): 원리와 방어 전략

## 1. DNS 스푸핑이란 무엇인가?

DNS(Domain Name System)는 `www.google.com`과 같은 사람이 읽기 쉬운 도메인 이름을 컴퓨터가 이해하는 IP 주소(`142.250.206.142`)로 변환해주는 인터넷의 핵심 주소록 시스템입니다. **DNS 스푸핑(Spoofing)**은 바로 이 주소록을 속여, 사용자를 의도치 않은 가짜 사이트로 보내는 모든 종류의 공격을 의미합니다.

- **DNS 캐시 포이즈닝 (Cache Poisoning):** DNS 스푸핑을 실행하는 가장 대표적인 방법입니다. 공격자가 DNS 서버의 캐시(임시 저장소)에 거짓 정보를 주입하여, 해당 DNS 서버를 이용하는 모든 사용자가 일정 기간 동안 가짜 사이트로 접속하게 만듭니다. 인터넷 전체를 대상으로 할 수 있어 매우 광범위하고 위험합니다.

## 2. 공격 시나리오 분석

DNS 스푸핑은 공격 대상과 환경에 따라 크게 두 가지 시나리오로 나눌 수 있습니다.

### 시나리오 1: DNS 캐시 포이즈닝 (광범위 공격)

이 시나리오는 통신사나 공용 DNS 서버 자체를 오염시키는 방식입니다.

1.  **공격 준비:** 공격자는 DNS 서버의 취약점을 찾아내, `www.bank.com`의 IP 주소가 자신의 악성 서버 IP(`9.8.7.6`)라는 거짓 정보를 준비합니다.
2.  **캐시 오염:** 공격자가 DNS 서버에 거짓 정보를 주입하는 데 성공하면, DNS 서버는 이 거짓 정보를 자신의 캐시에 저장합니다.
3.  **피해 발생:** 이후 해당 DNS 서버를 이용하는 모든 사용자가 `www.bank.com`을 요청하면, DNS 서버는 캐시에 저장된 거짓 IP(`9.8.7.6`)를 응답합니다.
4.  **정보 탈취:** 사용자의 브라우저는 주소창에 정상적인 주소를 표시하지만, 실제로는 공격자의 피싱 사이트로 접속하게 됩니다. 이때 브라우저는 목적지가 `www.bank.com`이라고 믿기 때문에, 해당 사이트의 모든 쿠키를 악성 서버로 전송하여 탈취당하게 됩니다.

### 시나리오 2: ARP 스푸핑을 이용한 중간자 공격 (공개 Wi-Fi 공격)

이것은 **"공개 Wi-Fi에서 쿠키를 확인한다"**는 말과 직결되는, 같은 네트워크 내의 특정 사용자를 노리는 로컬 공격 방식입니다.

#### **1단계: 네트워크 장악 - ARP 스푸핑 (ARP Spoofing)**

공격의 첫 단추는 DNS가 아니라 ARP(Address Resolution Protocol)입니다. 공격자는 같은 Wi-Fi에 접속한 피해자를 속여, 피해자의 모든 인터넷 트래픽이 자신의 컴퓨터를 거치도록 만듭니다. 이로써 공격자는 통신의 중간을 가로채는 **중간자(Man-in-the-Middle)**가 됩니다.

#### **2단계: DNS 요청 가로채기 및 조작 - 로컬 DNS 스푸핑**

피해자의 모든 통신이 공격자를 거치므로, DNS 요청 또한 가로챌 수 있습니다.

1.  피해자가 `www.bank.com`의 IP 주소를 DNS 서버에 요청합니다.
2.  공격자는 이 요청을 가로채서, 정상 DNS 서버 대신 자신이 직접 "그 IP 주소는 내 악성 서버 IP(`9.8.7.6`)야"라고 거짓 응답을 보냅니다.

#### **3단계: 쿠키 및 정보 탈취**

피해자의 브라우저는 공격자의 악성 서버로 접속을 시도하며, 여기서 통신의 암호화 여부가 중요해집니다.

- **HTTP 사이트 (암호화 안 됨):** 브라우저는 모든 쿠키와 데이터를 평문으로 전송합니다. 공격자는 패킷 분석 툴을 이용해 이 정보를 실시간으로 **그대로 엿보고 훔칠 수 있습니다.**
- **HTTPS 사이트 (암호화 됨):** 브라우저는 서버에게 유효한 SSL/TLS 인증서를 요구합니다. 공격자는 당연히 이 인증서가 없으므로, 브라우저는 **"이 사이트는 안전하지 않습니다"** 라는 강력한 보안 경고를 띄워 접속을 막습니다.

## 3. DNS 스푸핑 및 MITM 공격의 위협

- **쿠키 및 민감 정보 탈취:** 사용자의 세션 쿠키를 훔쳐 계정을 탈취하거나, 가짜 페이지를 통해 아이디/비밀번호, 금융 정보 등을 직접 입력하게 유도합니다.
- **파밍 (Pharming):** 불특정 다수를 피싱 사이트로 유도하는 광범위한 공격입니다.
- **악성코드 유포:** 가짜 사이트에서 악성 소프트웨어 다운로드를 유도합니다.

## 4. 대응 및 방어 전략

### 가장 중요한 방어선: HTTPS (SSL/TLS)

HTTPS는 DNS 스푸핑과 MITM 공격에 대한 **가장 효과적인 최종 방어선**입니다. 설령 사용자가 가짜 서버로 연결되더라도, 브라우저가 유효한 인증서가 없음을 감지하고 강력한 보안 경고를 띄워주기 때문입니다. **이 경고를 절대 무시해서는 안 됩니다.**

### 인프라 및 사용자 수준의 방어

1.  **신뢰할 수 없는 네트워크 사용 자제:** 보안이 검증되지 않은 공개 Wi-Fi에서는 민감한 작업을 피하는 것이 좋습니다. 부득이하게 사용 시에는 **VPN(가상 사설망)**을 사용하여 모든 트래픽을 암호화해야 합니다.
2.  **DNSSEC (DNS Security Extensions):** DNS 응답에 전자서명을 추가하여 응답이 위조되지 않았음을 검증하는 근본적인 해결책입니다.
3.  **신뢰할 수 있는 DNS 서버 사용:** 보안이 강화된 공용 DNS 서버(예: Google `8.8.8.8`, Cloudflare `1.1.1.1`)를 사용하면 일반적인 ISP DNS 서버보다 안전할 수 있습니다.
4.  **DNS 캐시 비우기:** PC가 오염된 DNS 정보를 기억하고 있을 수 있으므로, 의심될 경우 DNS 캐시를 수동으로 비우는 것이 도움이 됩니다.
